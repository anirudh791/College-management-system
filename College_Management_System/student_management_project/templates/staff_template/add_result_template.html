{% extends 'staff_template/base_template.html' %}

{% block content %}
<div class="container mt-4">
    <h2>Add / Update Student Result</h2>

    <!-- Display Messages -->
    {% if messages %}
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">{{ message }}</div>
        {% endfor %}
    {% endif %}

    <form method="POST" action="{% url 'staff_add_result_save' %}">
        {% csrf_token %}

        <!-- Subject -->
        <div class="form-group mt-3">
            <label for="subject">Select Subject:</label>
            <select name="subject" id="subject" class="form-control" required>
                <option value="">-- Select --</option>
                {% for subject in subjects %}
                    <option value="{{ subject.id }}">{{ subject.name }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Session Year -->
        <div class="form-group mt-3">
            <label for="session_year">Select Session Year:</label>
            <select name="session_year_id" id="session_year" class="form-control" required>
                <option value="">-- Select --</option>
                {% for session in session_years %}
                    <option value="{{ session.id }}">{{ session.session_start_year }} - {{ session.session_end_year }}</option>
                {% endfor %}
            </select>
        </div>

        <!-- Student (This dropdown should be dynamically populated based on subject/session) -->
        <div class="form-group mt-3">
            <label for="student_list">Select Student:</label>
            <select name="student_list" id="student_list" class="form-control" required>
                <!-- This should be populated dynamically using JS or server-side filtering -->
                <option value="">-- Select Student --</option>
            </select>
        </div>

        <!-- Assignment Marks -->
        <div class="form-group mt-3">
            <label for="assignment_marks">Assignment Marks:</label>
            <input type="number" name="assignment_marks" id="assignment_marks" class="form-control" required>
        </div>

        <!-- Exam Marks -->
        <div class="form-group mt-3">
            <label for="exam_marks">Exam Marks:</label>
            <input type="number" name="exam_marks" id="exam_marks" class="form-control" required>
        </div>

        <button type="submit" class="btn btn-success mt-3">Save Result</button>
    </form>
</div>

<!-- Optional JS placeholder to fetch students dynamically -->
<script>
    // Example for dynamic loading â€” replace with real AJAX call as needed
    document.getElementById("subject").addEventListener("change", function () {
        const subjectId = this.value;
        const sessionId = document.getElementById("session_year").value;

        // Perform AJAX to fetch students based on subjectId and sessionId
        // Populate student_list dropdown
    });
</script>
{% endblock %}
